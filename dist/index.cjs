"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const u=function(s,n){s&&n()},a=function(s,n=!0){const f=[],c={on:(o,t,e)=>(t==="onBefore"?o.onBefore((...r)=>u(n,()=>c.set(e(s,{args:r})))):t==="onSuccess"?o.onSuccess((r,...l)=>u(n,()=>c.set(e(s,{result:r,args:l})))):t==="onError"?o.onError((r,...l)=>u(n,()=>c.set(e(s,{error:r,args:l})))):o.onFinally((...r)=>u(n,()=>c.set(e(s,{args:r})))),c),get(){return s},set(o){s=o,f.forEach(t=>t(s))},subscribe(o){return f.push(o),()=>{const t=f.indexOf(o);~t&&f.splice(t,1)}},enableOn(o){return o.subscribe(()=>n=!0),c},disableOn(o){return o.subscribe(()=>n=!1),c}};return c},i=function(){return{afterAll:[],beforeAll:[],other:[]}},b=function(s){const n=i(),f=i(),c=i(),o=i(),t=async function(...e){return n.beforeAll.forEach(r=>r(...e)),n.other.forEach(r=>r(...e)),n.afterAll.forEach(r=>r(...e)),s(...e).then(r=>(f.beforeAll.forEach(l=>l(r,...e)),f.other.forEach(l=>l(r,...e)),f.afterAll.forEach(l=>l(r,...e)),r)).catch(r=>{throw c.beforeAll.forEach(l=>l(r,...e)),c.other.forEach(l=>l(r,...e)),c.afterAll.forEach(l=>l(r,...e)),r}).finally(()=>{o.beforeAll.forEach(r=>r(...e)),o.other.forEach(r=>r(...e)),o.afterAll.forEach(r=>r(...e))})};return t.onBefore=(e,r)=>{switch(r){case"beforeAll":n.beforeAll.push(e);break;case"afterAll":n.afterAll.push(e);break;default:n.other.push(e)}},t.onSuccess=(e,r)=>{switch(r){case"beforeAll":f.beforeAll.push(e);break;case"afterAll":f.afterAll.push(e);break;default:f.other.push(e)}},t.onError=(e,r)=>{switch(r){case"beforeAll":c.beforeAll.push(e);break;case"afterAll":c.afterAll.push(e);break;default:c.other.push(e)}},t.onFinally=(e,r)=>{switch(r){case"beforeAll":o.beforeAll.push(e);break;case"afterAll":o.afterAll.push(e);break;default:o.other.push(e)}},t},A=function(s,n,f=!0){console.log("Combine",s,n,f);let c=n(s);const o=[];s.forEach(e=>{e.subscribe(()=>{u(f,()=>{c=n(s),o.forEach(r=>r(c))})})});const t={on:()=>{throw new Error("Cannot call 'on' on combined store")},get(){return c},set(){throw new Error("Cannot call 'set' on combined store")},subscribe(e){return o.push(e),()=>{const r=o.indexOf(e);~r&&o.splice(r,1)}},enableOn(e){return e.subscribe(()=>f=!0),t},disableOn(e){return e.subscribe(()=>f=!1),t}};return t},E=function(s){const n=[],f={on:(c,o)=>(c==="onBefore"?o.onBefore(()=>n.forEach(t=>t()),s):c==="onSuccess"?o.onSuccess(()=>n.forEach(t=>t()),s):c==="onError"?o.onError(()=>n.forEach(t=>t()),s):o.onFinally(()=>n.forEach(t=>t()),s),f),subscribe:c=>{n.push(c)}};return f},h=function(s){return()=>s},p=function(s){const n=a(!1);return s.forEach(f=>{n.on(f,"onBefore",h(!0)),n.on(f,"onFinally",h(!1))}),n};exports.combine=A;exports.effect=b;exports.enableCheck=u;exports.marker=E;exports.pending=p;exports.store=a;exports.to=h;
